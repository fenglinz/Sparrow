@model News

@section Styles
{
    @Styles.Render("~/Content/RichEditor/css", "~/Content/fileinput/css")
}

@section Scripts
{
    @Scripts.Render("~/bundles/validate", "~/bundles/RichEditor", "~/bundles/fileinput")

    <script type="text/javascript">
        $(function () {
            var editor = new wangEditor('richBox');

            wangEditor.plugin({ 'removeImage': function (img) { alert(img.attr('src')); } });

            editor.create();

            $('#file').fileinput();

            $('#frmNews').on('submit', function () {
                $('#Content').val($('#richBox').html());

                return JudgeValidate('#frmNews');
            });
        });
    </script>
}

<div class="header">添加或编辑新闻</div>
@using (Html.BeginForm("CreateOrUpdate", "News", FormMethod.Post, new { @id = "frmNews", @class = "form-horizontal", @autocomplete = "off", @style = "margin-top: 10px;" }))
{
    @Html.AntiForgeryToken()
    @Html.HiddenFor(m => m.Id)
    @Html.HiddenFor(m => m.Content)

    <div class="form-group">
        @Html.LabelFor(m => m.Category, new { @class = "col-sm-2 control-label" })
        <div class="col-sm-8">
            @Html.CreateDropdownListFor(m => m.Category, "新闻分类", false)
        </div>
    </div>
    <div class="form-group">
        @Html.LabelFor(m => m.Title, new { @class = "col-sm-2 control-label" })
        <div class="col-sm-8">
            @Html.TextBoxFor(m => m.Title, new { @class = "form-control", @validate_rule = "notNull", @validate_field = "标题" })
        </div>
    </div>
    <div class="form-group">
        @Html.LabelFor(m => m.Content, new { @class = "col-sm-2 control-label" })
        <div class="col-sm-8">
            <div id="richBox" style="width: 100%; height: 340px;">@Html.Raw(Model != null ? Model.Content : "")</div>
        </div>
    </div>
    <div class="form-group">
        @Html.LabelFor(m => m.Attachments, new { @class = "col-sm-2 control-label" })
        <div class="col-sm-8">
            <input type="file" id="file" name="file" multiple class="form-control" />
        </div>
    </div>
    <div class="form-group">
        <span class="col-sm-2"></span>
        <div class="col-sm-9">
            <button class="btn btn-primary">
                <i class="glyphicon glyphicon-floppy-saved"></i> 保存
            </button>
            <a href="@Url.Action("Index")" class="btn btn-default">
                <i class="glyphicon glyphicon-chevron-left"></i> 返回
            </a>
        </div>
    </div>
}